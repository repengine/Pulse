# Module Analysis: [`forecast_output/forecast_formatter.py`](forecast_output/forecast_formatter.py:1)

## Module Intent/Purpose
Formats structured forecast objects into a human-readable Strategos Forecast Tile and persists forecasts to memory via `ForecastMemory`.

## Operational Status/Completeness
- Provides two functions: `format_forecast_tile` and `save_forecast`.
- No TODOs or placeholder code.
- Lacks error handling and input validation.
- Digest formatting mentioned in the module docstring is not implemented here.

## Implementation Gaps / Unfinished Next Steps
- The docstring refers to "Digest formatting" but no corresponding function exists.
- Extend module to support additional output formats (e.g., digest, narrative).
- Introduce validation for required forecast fields.
- Allow dynamic asset lists instead of hardcoded symbols.
- Add tests targeting formatting edge cases and persistence failures.

## Connections & Dependencies
- **Internal Imports**
  - `ForecastMemory` from [`memory/forecast_memory.py`](memory/forecast_memory.py:1)
  - `PATHS` from [`core/path_registry.py`](core/path_registry.py:1)
- **External Libraries**
  - `typing.Dict`
- **Data Persistence**
  - Uses `forecast_memory.store()` to save forecasts under `FORECAST_HISTORY`.

## Function and Class Example Usages
```python
from forecast_output.forecast_formatter import format_forecast_tile, save_forecast

forecast = {
    "horizon_days": 7,
    "origin_turn": 42,
    "trace_id": "abc-123",
    "forecast": {
        "start_capital": {"nvda": 1000, "msft": 500, "ibit": 300, "spy": 800},
        "end_capital":   {"nvda": 1100, "msft": 450, "ibit": 330, "spy": 820},
        "symbolic_change": "+5% â†’ +10%"
    },
    "fragility": "low",
    "confidence": 0.85,
    "alignment": {"bias": "neutral"},
    "status": "labeled"
}

# Format as a tile and print
tile_str = format_forecast_tile(forecast)
print(tile_str)

# Persist forecast to memory
save_forecast(forecast)
```

## Hardcoding Issues
- Exposure symbols (`NVDA`, `MSFT`, `IBIT`, `SPY`) are explicitly coded.
- Unicode separators and iconography are fixed in the template string.

## Coupling Points
- Assumes `forecast_obj` contains specific keys (`horizon_days`, `forecast`, etc.).
- Relies on `ForecastMemory` API signature and `PATHS["FORECAST_HISTORY"]`.

## Existing Tests
- No direct test file (e.g., `tests/test_forecast_formatter.py`).
- Formatting logic may be indirectly covered by broader forecast pipeline tests.

## Module Architecture and Flow
1. **Initialization**  
   - Global `forecast_memory` instance uses `PATHS["FORECAST_HISTORY"]`.
2. **Formatting**  
   - `format_forecast_tile` reads forecast fields and constructs a multi-line string.
3. **Persistence**  
   - `save_forecast` delegates storage to `ForecastMemory`.

## Naming Conventions
- Module and function names use `snake_case`.
- Constant `PATHS` is uppercase.
- Forecast object keys mix snake_case and lowercase symbols.

---

*Analysis generated by the Pulse documentation workflow.*